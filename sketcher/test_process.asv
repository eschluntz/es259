clear;
close all;

files = {'data/bridge.jpg', 'data/steve.jpg', 'data/lenna.jpg', ...
         'data/mona lisa.jpg', 'data/nighthwk.jpg', 'data/opera.jpg'...
         'data/self.jpg'};
     
for j = 1:size(files,2)
    img = imread(files{j});
    %figure;
    %imshow(img);
    gray = rgb2gray(img);
    %figure;
    %imshow(gray);
    BW = edge(gray, 'canny', ., 2);
    figure;
    imshow(BW);
    %{
    [H,theta,rho] = hough(BW);
    
    figure, imshow(imadjust(mat2gray(H)),[],'XData',theta,'YData',rho,...
        'InitialMagnification','fit');
    xlabel('\theta (degrees)'), ylabel('\rho');
    axis on, axis normal, hold on;
    colormap(hot)
    
    P = houghpeaks(H,5,'threshold',ceil(0.3*max(H(:))));
    lines = houghlines(BW,theta,rho,P,'FillGap',5,'MinLength',7);
    
    figure, imshow(img), hold on
    max_len = 0;
    for k = 1:length(lines)
       xy = [lines(k).point1; lines(k).point2];
       plot(xy(:,1),xy(:,2),'LineWidth',2,'Color','green');

       % Plot beginnings and ends of lines
       plot(xy(1,1),xy(1,2),'x','LineWidth',2,'Color','yellow');
       plot(xy(2,1),xy(2,2),'x','LineWidth',2,'Color','red');

       % Determine the endpoints of the longest line segment
       len = norm(lines(k).point1 - lines(k).point2);
       if ( len > max_len)
          max_len = len;
          xy_long = xy;
       end
    end
    %}
end
    
